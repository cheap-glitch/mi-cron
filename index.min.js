"use strict";
/*!
 * mi-cron
 *
 * A microscopic parser for standard cron expressions.
 *
 * Copyright (c) 2020-present, cheap glitch
 * This software is distributed under the ISC license
 */Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseCron=void 0;const t={"@hourly":"0 * * * *","@daily":"0 0 * * *","@weekly":"0 0 * * 0","@monthly":"0 0 1 * *","@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *"};function e(r){const n=r.trim().split(/\s+/);if(1==n.length)return n[0]in t?e(t[n[0]]):void 0;if(5==n.length){let t=void 0;try{t={minutes:s(n[0],0,59),hours:s(n[1],0,23),days:s(n[2],1,31),months:s(n[3],1,12,["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]),weekDays:s(n[4],0,6,["sun","mon","tue","wed","thu","fri","sat"])}}catch(t){return}return t}}exports.parseCron=e;const r="(\\d{1,2}|[a-z]{3})",n=new RegExp(`^${r}(?:-${r})?$`,"i");function s(t,e,r,s=[]){const o=Array.from(new Set(t.split(",").flatMap(t=>{const[o,u="1"]=t.split("/",2),a=parseInt(u,10);if(Number.isNaN(a))throw Error();if("*"==o)return i(e,r,a);const c=o.match(n);if(!c)throw Error();const[l,f=(t.includes("/")?r:void 0)]=c.slice(1).map(t=>{if(s.includes(t))return s.indexOf(t);const n=parseInt(t,10);return!Number.isNaN(n)&&e<=n&&n<=r?n:void 0});if(void 0===l||void 0!==f&&f<l)throw Error();return null==f?[l]:i(l,f,a)})));return o.sort((t,e)=>t-e),o}function o(t){return new Date(Date.UTC(t.years,t.months-1,t.days,t.hours,t.minutes))}function i(t,e,r){return Array.from({length:Math.floor((e-t)/r)+1}).map((e,n)=>t+n*r)}e.nextDate=function(t,r=new Date){const n="string"==typeof t?e(t):t;if(void 0===n)return;const s={years:r.getUTCFullYear(),months:r.getUTCMonth()+1,days:r.getUTCDate(),hours:r.getUTCHours(),minutes:r.getUTCMinutes()+1},i=Object.keys(s);for(let t=1;t<i.length;t++){const e=i[t];if(!n[e].includes(s[e])){i.filter((e,r)=>r>t).forEach(t=>s[t]=n[t][0]);const r=n[e].find(t=>t>=s[e]);void 0!==r?s[e]=r:(s[e]=n[e][0],s[i[t-1]]++,t="months"!=e?t-2:t)}"days"!=e||n.weekDays.includes(o(s).getUTCDay())||(s.days++,s.hours=n.hours[0],s.minutes=n.minutes[0],t=1)}return o(s)};